<div class="detail-top">
	<h1>{{titleAlterar}} {{#each dados}}#{{id}}</h1>
	<a id="button-alterar" class="button basic">Voltar</a>
    <a id="button-deletar-pedido" class="button danger">Deletar</a>
</div>

<div class="container-form">
	<h2 class="title-form">Preencha todas informações abaixo:</h2>
	<form action="/alterarDadosPedido" method="POST" class="form-style">

		<div class="forms-campo">
			<label for="id" class="form-label">Id *</label>
			<input type="text" class="form-text campo-bloqueado" id="id" name="id" value="{{id}}" required readonly>
		</div>

		<div class="form-group">
				<label>Comprador</label>
				<select class="form-control select2 select2-hidden-accessible" style="width: 100%;" tabindex="-1" aria-hidden="true" name="codigoComprador" id="select-comprador">
				</select>
			</div>
		<div class="forms-campo">
			<label for="quantidadeLitros" class="form-label">Quantidade de litros de leite *</label> 
			<input type="text" class="form-text" id="quantidadeLitros" name="quantidadeLitros" value="{{quantidadeLitros}}" required>
		</div>
       
		<div class="forms-campo">
			<label for="valor" class="form-label">Valor *</label>
			<input type="text" class="form-text" id="valor" name="valor" value="{{valor}}" required>
		</div>
		<div class="form-group">	
				<label>Data de vencimento*</label>					
				<div class="input-group date">
					<div class="input-group-addon">
						<i class="fa fa-calendar"></i>
					</div>
					<input type="text" class="form-control pull-right" id="datepicker" name="dataVencimento">
				</div>
		</div>
		<div class="forms-campo">
			<label for="descricao" class="form-label">Descrição *</label>
			<input type="text" class="form-text" id="descricao" name="descricao" value="{{descricao}}" required>
		</div>
		<div class="form-group">
				<label>Parcelamento</label>
				<div class="radio">
					<label>
						<input type="radio" name="parcelamento" id="parcelamentoOption" value="FALSE" checked="">
						Não
					</label>
				</div>
				<div class="radio">
					<label>
						<input type="radio" class="parcelamentoOptionTrue" name="parcelamento" id="parcelamentoOption" value="TRUE">
						Sim
					</label>
				</div>
			</div>
			<div class="form-group" id="quantparcelamento" style="display:none">
				<label>Quantidade de parcelamento</label>
				<select class="form-control" name="quantparcelamento">
					<option name="quantparcelamento" value="1">1x</option>
					<option name="quantparcelamento" value="2">2x</option>
					<option name="quantparcelamento" value="3">3x</option>					
				</select>
			</div>
        {{/each}}
		<hr>
		<input type="submit" value="Salvar" class="button sucess">
		<a class="button danger">Cancelar</a>
	</form>
	<!-- Modal -->
	<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="modalDeletar" aria-hidden="true">
			<div class="modal-dialog" role="document">
				<div class="modal-content">
					<div class="modal-header">
					<h5 class="modal-title" id="modalDeletar">DELETAR PEDIDO</h5>
					<button type="button" class="close" data-dismiss="modal" aria-label="Close">
						<span aria-hidden="true">&times;</span>
					</button>
					</div>
					<div class="modal-body">
					Ei, deseja realmente deletar o cadastro deste Pedido?
					</div>
					<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
					<button type="button" class="btn btn-danger" data-path="../deletarPedido" id="confirmarDeletar">Deletar</button>
					</div>
				</div>
			</div>
	</div>
</div>

{{#extend "js"}}
<script type="text/javascript" src="../js/select2.full.min.js"></script>
<script>
	$(document).ready(function () {
		if ($("#quantparcelamento").is(':checked')){
			$("#quantparcelamento").css('display', 'block')
		}
		else {
			$("#quantparcelamento").css('display', 'none')
		}

		$('input[type="radio"]').click(function(){
			if ($(this).val() === 'TRUE'){
				$("#quantparcelamento").css('display', 'block')
			}
			else {
				$("#quantparcelamento").css('display', 'none')
			}
		});

		$.get("/readComprador", data => {
			let option = []
			data.forEach(comprador => {
				option.push(`<option name="codigoComprador" value="${comprador.id}">${comprador.responsavellegal} - ${comprador.id}</option>"`)
			});
			$("#select-comprador").append(option)
		});

		$('.select2').select2();
		
		$("#button-deletar-pedido").click(function(){
			$("#myModal").modal();

			$("#confirmarDeletar").click(function(){
				var pathEdit = $(this).attr('data-path');
				var id = $('#id').val();
				location.href = pathEdit + '/' + id;
			});

		});
	});
</script>

{{/extend}}