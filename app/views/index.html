<div class="row">
  <div class="col-lg-3 col-xs-6">
    <!-- small box -->
    <div class="small-box bg-green">
      <div class="inner">
        <h3 id="quantidadeGado"></h3>

        <p>Quantidade cabeças de gado</p>
      </div>
      <div class="icon">
        <i class="fa fa-paw"></i>
      </div>
      <a href="/consultarGado" class="small-box-footer">Mais informações <i class="fa fa-arrow-circle-right"></i></a>
    </div>
  </div>
  <!-- ./col -->
  <div class="col-lg-3 col-xs-6">
    <!-- small box -->
    <div class="small-box bg-red">
      <div class="inner">
        <h3 id="statusGado"></h3>

        <p>Cabeças de gado inativas</p>
      </div>
      <div class="icon">
        <i class="ion ion-stats-bars"></i>
      </div>
      <a href="/consultarGado" class="small-box-footer">Mais informações <i class="fa fa-arrow-circle-right"></i></a>
    </div>
  </div>
  <!-- ./col -->
  <div class="col-lg-3 col-xs-6">
    <!-- small box -->
    <div class="small-box bg-yellow">
      <div class="inner">
          <h3 id="countLeite"></h3>

        <p>Produto disponivel(Litros)</p>
      </div>
      <div class="icon">
        <i class="ion ion-person-add"></i>
      </div>
      <a href="/consultarOrdenha" class="small-box-footer">More info <i class="fa fa-arrow-circle-right"></i></a>
    </div>
  </div>
  <!-- ./col -->
  <div class="col-lg-3 col-xs-6">
    <!-- small box -->
    <div class="small-box bg-aqua" id="box-profit">
      <div class="inner">
        <h3 id="outputMoney"></h3>
        <p>Lucro em caixa</p>
      </div>
      <div class="icon">
        <i class="fa fa-money"></i>
      </div>
      <a href="/transacoes" class="small-box-footer">Mais informações <i class="fa fa-arrow-circle-right"></i></a>
    </div>
  </div>
  <!-- ./col -->
</div>

{{#extend "js"}}
<script>
  $(document).ready(() => {
    $.get("/readGado", data => {
      $('#quantidadeGado').html(data.length);
      const inativo = data.filter(elem => {
        if (elem.status === 'inativo') {
          return elem
        };
      });
    });

    $.get("/transactions", data => {
      let inputMoney = 0;
      let outputMoney = 0;

      data.forEach(elem => {
        if (elem.tipo === 'RECEITA') inputMoney += parseFloat(elem.valor);
        if (elem.tipo === 'DESPESAS') outputMoney += parseFloat(elem.valor);
      });
      const profit = inputMoney - outputMoney;
      $("#outputMoney").html('R$ ' + profit);
      if (profit < 0) {
        $('#box-profit').removeClass('bg-aqua');
        $('#box-profit').addClass('bg-red');
      }
    });

    $.get("/readGado", data => {
      let statusGado = 0;
      data.forEach(elem => {
        if (elem.status === 'Inativo') statusGado += 1;
        $('#statusGado').html('' + statusGado);
      });
    });    

    $.get("/readOrdenha", data => {
      let countLeite = 0;
      data.forEach(elem => {
        countLeite += parseFloat(elem.litrosleite);
      });

      $.get("/readPedidos", data => {

        let countLeiteNegativo = 0;

        data.forEach(elem => {
          countLeiteNegativo += parseFloat(elem.quantidadelitros);
        });
        let valor = countLeite - countLeiteNegativo;      
        $('#countLeite  ').html('' + valor);
      });
    });
  });
</script>
{{/extend}}